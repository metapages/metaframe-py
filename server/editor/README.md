This help is partially obsolete, rewrite this:
 - put the metaframe/page stuff at the bottom
 - link the github repo here
 - give code examples for e.g. 
   - resizing root dive detection on on editor mode
   - waiting until the metaframe is loaded
   - setting a cleanup/dispose function for when reloading the js code 


## Useful code snippets

### Get the root display div element

```javascript
const root = document.getElementById("root");

// All your elements go into "root".

```

### Wait until page `load` or `DOMContentLoaded`

You don't need to wait for the `load` or `DOMContentLoaded` event, your script will not run until `DOMContentLoaded` is fired.

### Window resize

Resizing happens when the editor layer is active. You might want to listen to this resize for e.g. graphical effects.

Example, listening to both the window resize event and the local `div` element resize:

```javascript
const handleResize = () => {
	const width = root.getBoundingClientRect().width;
	const height = root.getBoundingClientRect().height;
  // Your own code here, handling the resize
}


window.addEventListener("resize", handleResize, false);

const resizeObserver = new ResizeObserver((entries) => handleResize);
resizeObserver.observe(root);

window.scriptUnload = () => {
	resizeObserver.disconnect();
	window.removeEventListener("resize", handleResize);
}

```


### Unload/cleanup

When iterating with the code editor, the script is removed then re-added to the dom. Despite removing the script tag, the script itself is still in the javascript engine. In some cases, this can cause problems as multiple listeners maybe responding to the same event.

This is not an issue when simply running the page with code, since it only runs once.

To have your script cleaned up because of new script (when editing), set a function `scriptUnload` on the window, this will be called prior to a new script added:

```javascript
window.scriptUnload = () => {
	console.log("internal scriptUnload call")
	// do your cleanup here
}
```

# Run user javascript in a metaframe




This is a metaframe:

[![](https://mermaid.ink/svg/pako:eNqFkU9LxDAQxb9KiJcVuqC9KBG8uN7sRT1JL2MzaYP5RzJhle1-d9NWd1HBnVMm770fw8yOd14iF7yPEAb28Ng6VqozkNIGFbPhzhsfmdLGiLPrK3mhVJUo-jf81a63WtIg6vB-szBSfl2gFgkC9Lh8T2VQ0eUqh5JEsLNBRbB4ztbr21G7kCmNrFk9Dzqx5qAKIb7m-YmqT6OOgWYS2OgzLVLU_VCGkX7r_jBOpOr_Uuhk63jFLUYLWpYV7yah5TSgxZaL8pSoIBtqeev2xZqDBMJ7qclHLhSYhBWHTP7pw3VcUMz4bdpoKMu1B1cA9-L9sccZ0iy3nU-8_wSxOqSj)](https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNqFkU9LxDAQxb9KiJcVuqC9KBG8uN7sRT1JL2MzaYP5RzJhle1-d9NWd1HBnVMm770fw8yOd14iF7yPEAb28Ng6VqozkNIGFbPhzhsfmdLGiLPrK3mhVJUo-jf81a63WtIg6vB-szBSfl2gFgkC9Lh8T2VQ0eUqh5JEsLNBRbB4ztbr21G7kCmNrFk9Dzqx5qAKIb7m-YmqT6OOgWYS2OgzLVLU_VCGkX7r_jBOpOr_Uuhk63jFLUYLWpYV7yah5TSgxZaL8pSoIBtqeev2xZqDBMJ7qclHLhSYhBWHTP7pw3VcUMz4bdpoKMu1B1cA9-L9sccZ0iy3nU-8_wSxOqSj)



that runs arbitrary user javascript that embeds in the URL:

 - user created javascript
 - user defined css modules

Think of this like [codepen](https://codepen.io) or [others](https://www.sitepoint.com/code-playgrounds/) but stripped down focusing on core essentials, performance, and durability

## Examples

  - [Rotate stick on canvas from incoming angles](https://app.metapages.org/#?definition=eyJtZXRhIjp7ImxheW91dHMiOnsicmVhY3QtZ3JpZC1sYXlvdXQiOnsibGF5b3V0IjpbeyJoIjoyLCJpIjoic3RpY2siLCJtb3ZlZCI6ZmFsc2UsInN0YXRpYyI6ZmFsc2UsInciOjIsIngiOjAsInkiOjB9LHsiaCI6NSwiaSI6InJhbmRvbS1kYXRhIiwibW92ZWQiOmZhbHNlLCJzdGF0aWMiOmZhbHNlLCJ3Ijo2LCJ4IjowLCJ5IjoyfV0sInByb3BzIjp7ImNvbHMiOjEyLCJjb250YWluZXJQYWRkaW5nIjpbNSw1XSwibWFyZ2luIjpbMTAsMjBdLCJyb3dIZWlnaHQiOjEwMH19fX0sIm1ldGFmcmFtZXMiOnsiZWRpdC1saW5rIjp7InVybCI6Imh0dHBzOi8vbWFya2Rvd24ubXRmbS5pby8jP2Jhc2U2ND1JeUJWVWt3Z2RHOGdaV1JwZERvS0NpaHdZWE4wWlNCMGFHVWdibVYzSUZWU1RDQnBiblJ2SUhSb1pTQmdiV1YwWVdaeVlXMWxjMXNpYzNScFkyc2lYUzUxY214Z0lHWnBaV3hrSUhSdklIVndaR0YwWlNrS0NsdGxaR2wwSUcxbFhTaG9kSFJ3Y3pvdkwycHpMV055WldGMFpTNXRkR1p0TG1sdkx6OTJQVEVtWXoxbGVVcDBZakpTTVdKSFZucEphbkJpV0Znd0pUTkVJejlxY3oxWk1qbDFZek5SWjFwSGJIcGpSemw2V2xoS2VrbEVNR2RYTVRBM1EyMU9kbUp1VGpCSlNFcDJZak5SWjFCVFFtdGlNazR4WWxkV2RXUkROVzVhV0ZKR1lrZFdkRnBYTlRCUmJteEtXa05uYVdOdE9YWmtRMGx3VDNkd00yRkhiSE5hVTBGdlkyMDVkbVJETlcxaFdFcDZaRVZPYjJGWGVHdExVMEkzUTJsQloyTnRPWFprUXpWNVdsY3hkbVJ0VmtSaFIyeHpXa05vZVdJeU9UQk1iWGhvWXpOU1JHRkhiSE5hUTJzM1EyNHdTMHg1T0dkamJWWjFXa2RXZVVsSVVtOWFVMEpvWW0xa2MxcFJjREpaV0VsbldUSkdkV1J0Um5wSlJEQm5Xa2M1YW1SWE1XeGlibEYxV1ROS2JGbFlVbXhTVjNoc1lsZFdkV1JEWjJsWk1rWjFaRzFHZWtscGF6ZERiVTVvWW01YWFHTjVOVE5oVjFJd1lVTkJPVWxFU1hkTlJITkxXVEpHZFdSdFJucE1iV2hzWVZka2IyUkRRVGxKUkVsM1RVUnpTMk50T1haa1F6Vm9ZMGhDYkdKdFVrUmhSMnh6V2tOb2FsbFhOVEpaV0Uxd1QzZHZTMWt5T1hWak0xRm5XVE5TTkVsRU1HZFpNa1oxWkcxR2VreHRaR3hrUlU1MlltNVNiR1ZJVVc5SmFrcHJTV2xyTjBOdFRuWmliazR3U1VaME0weERRbTlZVTBFNVNVWnplVTFEZDJkWk1rWjFaRzFHZWt4dGFHeGhWMlJ2WkVZd04wTnRUblppYms0d1NVWjBORXhEUWpWWVUwRTVTVVowYWxsWE5USlpXRTExWkRKc2EyUkhaMmRNZVVGNVRFTkNhbGxYTlRKWldFMTFZVWRXY0ZveWFEQkpRemhuVFd3d04wTm5jR3BpTWpWNlpFTkNhMk50UmpOSlJEQm5TMGhLYUZwRGEyZFFWRFJuWlhkdlowbEhUakJsUXpWcVlrZFdhR05zU214Wk0xRnZUVU4zWjAxRGQyZFpNa1oxWkcxR2VreHVaSEJhU0ZKdlRFTkNhbGxYTlRKWldFMTFZVWRXY0ZveWFEQkxWSE5MUTJsQloweDVPR2RhYld4NVl6TlJaMk15UmpKYVUwSXdZVWRWWjJSWE5UQmpiVVoxWXpKNGFHUkhWbXRNTTFaMVkyMDVNRmxZVW14YVEwSnFZakkxTUZwWWFEQkRhVUZuV1ROU05FeHVUbWhrYlZWdlMxUnpTME5wUVdkWk0xSTBURzFLYkZveWJIVlZSMFl3WVVObmNFOTNiMmRKUXpoMlNVY3hkbVJ0Vldka1IyaHNTVWhLZG1SSFJqQmhWemwxU1VoQ2RtRlhOVEJKU0ZKMlNVaFNiMXBUUW1wYVZ6VXdXbGhKWjJJeVdXZGtSMmhzU1VoS2JGa3pVVXRKUTBKcVpFaG5kV1JJU21oaWJrNXpXVmhTYkV0SVozTkpSMmRuVEhsQmVVdFVjMHRKUTBGMlRIbENlV0l6VW1oa1IxVm5aRWRvYkVsSVNteFpNMUZMU1VOQ2FtUklaM1ZqYlRrd1dWaFNiRXRJU21oYVEyczNRMmR2WjBsRE9IWkpSMUo1V1ZoaloyUkhhR3hKU0Vwc1dUTlJaMkl5Tkdka1IyaHNTVWhTZVZsWE5YcGFiVGw1WWxkV2EwbEhUblppYmxKc1pVaFJTMGxEUW1wa1NHZDFZMjFXYW1SRFozUmtlVUYyU1VSSmMwbERNVzlKUXpoblRXbDNaMlI1ZDJkaFEyczNRMmR2WjBsSFRqQmxRelZ0WVZkNGMxVXpValZpUjFWblVGTkJhVm96U214YVZ6UnBUM2R2WjBsSFRqQmxRelZ0WVZkNGMwdERhemREWjI5blNVZE9NR1ZETlhsYVdFNHdZak5LYkV0RGF6ZERiakEzUTJkdmRreDVRazFoV0U0d1dsYzBaMlJIT0dkWlZ6Um5ZVmMxZDJSWVVVdGFSMng2WTBjNWVscFlTbnBNYmtJeFl6Sm5iME5wUVdkaVYxWXdXVmRhZVZsWE1XeE1iVGwxVTFjMWQyUllVbnBMUTJod1ltNUNNV1JJVFhCSlJEQXJTVWh6UzBsRFFXZEpSekZzWkVkR2JXTnRSblJhVXpWNldsaFNVR1JZVW5ka1dGSjZTMGRzZFdOSVZqQmplV3MzUTJsQlowbERRbXBpTWpWNlpFTkNOVWxFTUdkaFZ6VjNaRmhTZWxkNVNqVkpiREEzUTJsQlowbERRbkJhYVVGdlNWaHJjRWxJYzB0SlEwRm5TVU5CWjJOdFZqQmtXRXAxVDNkdlowbERRV2RtVVc5blNVTkJaMXBJU21oa2VXZzFTMVJ6UzBsRFFqbExVVzl3VDNkd2EyTnRSak5MUkVGd1QzZHZTMHg1T0dkVmJWWXdaRmhLZFVsSFJXZFpNbmhzV1ZjMU1XTkRRbTFrVnpWcVpFZHNkbUpuY0hsYVdGSXhZMjAwWjB0RGEyZFFWRFJuWlhkdlowbElaRzloVjNoc1NVTm9hMkZZVG5kaU0wNXNZMjVOZFdKSFZuVmFNMUp2U1VRMFowMURhMmRsZDI5blNVTkJaMXBIYkhwalJ6bDZXbGhLZWt4dVFuWmpRMmR3UzBOck4wTnBRV2RtVVhBNVQzZHZQU1p2Y0hScGIyNXpQV1Y1U205aFYxSnNZbGRXZFdSWGJHMWhWMXA1V1ZjeGJFbHFjREJqYmxac1RFTktkR0l5VW14SmFtOXBZVzFHTWxsWVRtcGpiV3gzWkVOSmMwbHVUbWhrYlZaellqSkdhMkZYTlc5WldFNXZTV3B3TUdOdVZteE1RMG93WVVkV2RGcFRTVFpKYlhod1dqSm9NRWx1TUQwbWRHVjRkRDFaTWpsMVl6TlJaMXBIYkhwalJ6bDZXbGhLZWtsRU1HZFhNVEEzUTIxT2RtSnVUakJKU0VwMllqTlJaMUJUUW10aU1rNHhZbGRXZFdSRE5XNWFXRkpHWWtkV2RGcFhOVEJSYm14S1drTm5hV050T1haa1EwbHdUM2R3TTJGSGJITmFVMEZ2WTIwNWRtUkROVzFoV0VwNlpFVk9iMkZYZUd0TFUwSTNRMmxCWjJOdE9YWmtRelY1V2xjeGRtUnRWa1JoUjJ4eldrTm9lV0l5T1RCTWJYaG9Zek5TUkdGSGJITmFRMnMzUTI0d1MweDVPR2RqYlZaMVdrZFdlVWxJVW05YVUwSm9ZbTFrYzFwUmNESlpXRWxuV1RKR2RXUnRSbnBKUkRCbldrYzVhbVJYTVd4aWJsRjFXVE5LYkZsWVVteFNWM2hzWWxkV2RXUkRaMmxaTWtaMVpHMUdla2xwYXpkRGJVNW9ZbTVhYUdONU5UTmhWMUl3WVVOQk9VbEVTWGROUkhOTFdUSkdkV1J0Um5wTWJXaHNZVmRrYjJSRFFUbEpSRWwzVFVSelMyTnRPWFprUXpWb1kwaENiR0p0VWtSaFIyeHpXa05vYWxsWE5USlpXRTF3VDNkdlMxa3lPWFZqTTFGbldUTlNORWxFTUdkWk1rWjFaRzFHZWt4dFpHeGtSVTUyWW01U2JHVklVVzlKYWtwclNXbHJOME50VG5aaWJrNHdTVVowTTB4RFFtOVlVMEU1U1VaemVVMURkMmRaTWtaMVpHMUdla3h0YUd4aFYyUnZaRVl3TjBOdFRuWmliazR3U1VaME5FeERRalZZVTBFNVNVWjBhbGxYTlRKWldFMTFaREpzYTJSSFoyZE1lVUY1VEVOQ2FsbFhOVEpaV0UxMVlVZFdjRm95YURCSlF6aG5UV3d3TjBObmNHcGlNalY2WkVOQ2EyTnRSak5KUkRCblMwaEthRnBEYTJkUVZEUm5aWGR2WjBsSFRqQmxRelZxWWtkV2FHTnNTbXhaTTFGdlRVTjNaMDFEZDJkWk1rWjFaRzFHZWt4dVpIQmFTRkp2VEVOQ2FsbFhOVEpaV0UxMVlVZFdjRm95YURCTFZITkxRMmxCWjB4NU9HZGFiV3g1WXpOUloyTXlSakphVTBJd1lVZFZaMlJYTlRCamJVWjFZeko0YUdSSFZtdE1NMVoxWTIwNU1GbFlVbXhhUTBKcVlqSTFNRnBZYURCRGFVRm5XVE5TTkV4dVRtaGtiVlZ2UzFSelMwTnBRV2RaTTFJMFRHMUtiRm95YkhWVlIwWXdZVU5uY0U5M2IyZEpRemgyU1VjeGRtUnRWV2RrUjJoc1NVaEtkbVJIUmpCaFZ6bDFTVWhDZG1GWE5UQkpTRkoyU1VoU2IxcFRRbXBhVnpVd1dsaEpaMkl5V1dka1IyaHNTVWhLYkZrelVVdEpRMEpxWkVobmRXUklTbWhpYms1eldWaFNiRXRJWjNOSlIyZG5USGxCZVV0VWMwdEpRMEYyVEhsQ2VXSXpVbWhrUjFWblpFZG9iRWxJU214Wk0xRkxTVU5DYW1SSVozVmpiVGt3V1ZoU2JFdElTbWhhUTJzM1EyZHZaMGxET0haSlIxSjVXVmhqWjJSSGFHeEpTRXBzV1ROUloySXlOR2RrUjJoc1NVaFNlVmxYTlhwYWJUbDVZbGRXYTBsSFRuWmlibEpzWlVoUlMwbERRbXBrU0dkMVkyMVdhbVJEWjNSa2VVRjJTVVJKYzBsRE1XOUpRemhuVFdsM1oyUjVkMmRoUTJzM1EyZHZaMGxIVGpCbFF6VnRZVmQ0YzFVelVqVmlSMVZuVUZOQmFWb3pTbXhhVnpScFQzZHZaMGxIVGpCbFF6VnRZVmQ0YzB0RGF6ZERaMjluU1VkT01HVkROWGxhV0U0d1lqTktiRXREYXpkRGJqQTNRMmR2ZGt4NVFrMWhXRTR3V2xjMFoyUkhPR2RaVnpSbllWYzFkMlJZVVV0YVIyeDZZMGM1ZWxwWVNucE1ia0l4WXpKbmIwTnBRV2RpVjFZd1dWZGFlVmxYTVd4TWJUbDFVMWMxZDJSWVVucExRMmh3WW01Q01XUklUWEJKUkRBclNVaHpTMGxEUVdkSlJ6RnNaRWRHYldOdFJuUmFVelY2V2xoU1VHUllVbmRrV0ZKNlMwZHNkV05JVmpCamVXczNRMmxCWjBsRFFtcGlNalY2WkVOQ05VbEVNR2RoVnpWM1pGaFNlbGQ1U2pWSmJEQTNRMmxCWjBsRFFuQmFhVUZ2U1ZocmNFbEljMHRKUTBGblNVTkJaMk50VmpCa1dFcDFUM2R2WjBsRFFXZG1VVzluU1VOQloxcElTbWhrZVdnMVMxUnpTMGxEUWpsTFVXOXdUM2R3YTJOdFJqTkxSRUZ3VDNkdlMweDVPR2RWYlZZd1pGaEtkVWxIUldkWk1uaHNXVmMxTVdORFFtMWtWelZxWkVkc2RtSm5jSGxhV0ZJeFkyMDBaMHREYTJkUVZEUm5aWGR2WjBsSVpHOWhWM2hzU1VOb2EyRllUbmRpTTA1c1kyNU5kV0pIVm5WYU0xSnZTVVEwWjAxRGEyZGxkMjluU1VOQloxcEhiSHBqUnpsNldsaEtla3h1UW5aalEyZHdTME5yTjBOcFFXZG1VWEE1VDNkdlBTa0tDZz09In0sInJhbmRvbS1kYXRhIjp7InVybCI6Imh0dHBzOi8vcmFuZG9tLm10Zm0uaW8vIz9kaXN0cmlidXRpb249ZXlKa2FYTjBjbWxpZFhScGIyNGlPaUp6YVc0aUxDSm1jbVZ4ZFdWdVkza2lPakV3TENKdmNIUnBiMjV6SWpwN0ltbHVZM0psYldWdWRDSTZNQzR4ZlN3aWMyaHZkMDkxZEhCMWRDSTZabUZzYzJWOSJ9LCJzdGljayI6eyJpbnB1dHMiOlt7Im1ldGFmcmFtZSI6InJhbmRvbS1kYXRhIiwic291cmNlIjoidiIsInRhcmdldCI6InkifV0sInVybCI6Imh0dHBzOi8vanMubXRmbS5pby8/dj0xJmM9ZXlKdGIyUjFiR1Z6SWpwYlhYMCUzRCM/anM9WTI5dWMzUWdaR2x6Y0c5elpYSnpJRDBnVzEwN0NtTnZibk4wSUhKdmIzUWdQU0JrYjJOMWJXVnVkQzVuWlhSRmJHVnRaVzUwUW5sSlpDZ2ljbTl2ZENJcE93cDNhR2xzWlNBb2NtOXZkQzVtYVhKemRFTm9hV3hrS1NCN0NpQWdjbTl2ZEM1eVpXMXZkbVZEYUdsc1pDaHliMjkwTG14aGMzUkRhR2xzWkNrN0NuMEtMeThnY21WdVpHVnlJSFJvWlNCaGJtZHNaUXAyWVhJZ1kyRnVkbUZ6SUQwZ1pHOWpkVzFsYm5RdVkzSmxZWFJsUld4bGJXVnVkQ2dpWTJGdWRtRnpJaWs3Q21OaGJuWmhjeTUzYVdSMGFDQTlJREl3TURzS1kyRnVkbUZ6TG1obGFXZG9kQ0E5SURJd01Ec0tjbTl2ZEM1aGNIQmxibVJEYUdsc1pDaGpZVzUyWVhNcE93b0tZMjl1YzNRZ1kzUjRJRDBnWTJGdWRtRnpMbWRsZEVOdmJuUmxlSFFvSWpKa0lpazdDbU52Ym5OMElGdDNMQ0JvWFNBOUlGc3lNQ3dnWTJGdWRtRnpMbWhsYVdkb2RGMDdDbU52Ym5OMElGdDRMQ0I1WFNBOUlGdGpZVzUyWVhNdWQybGtkR2dnTHlBeUxDQmpZVzUyWVhNdWFHVnBaMmgwSUM4Z01sMDdDZ3BqYjI1emRDQmtjbUYzSUQwZ0tISmhaQ2tnUFQ0Z2V3b2dJR04wZUM1amJHVmhjbEpsWTNRb01Dd2dNQ3dnWTJGdWRtRnpMbmRwWkhSb0xDQmpZVzUyWVhNdWFHVnBaMmgwS1RzS0NpQWdMeThnWm1seWMzUWdjMkYyWlNCMGFHVWdkVzUwY21GdWMyeGhkR1ZrTDNWdWNtOTBZWFJsWkNCamIyNTBaWGgwQ2lBZ1kzUjRMbk5oZG1Vb0tUc0tDaUFnWTNSNExtSmxaMmx1VUdGMGFDZ3BPd29nSUM4dklHMXZkbVVnZEdobElISnZkR0YwYVc5dUlIQnZhVzUwSUhSdklIUm9aU0JqWlc1MFpYSWdiMllnZEdobElISmxZM1FLSUNCamRIZ3VkSEpoYm5Oc1lYUmxLSGdzSUdnZ0x5QXlLVHNLSUNBdkx5QnliM1JoZEdVZ2RHaGxJSEpsWTNRS0lDQmpkSGd1Y205MFlYUmxLSEpoWkNrN0Nnb2dJQzh2SUdSeVlYY2dkR2hsSUhKbFkzUWdiMjRnZEdobElIUnlZVzV6Wm05eWJXVmtJR052Ym5SbGVIUUtJQ0JqZEhndWNtVmpkQ2d0ZHlBdklESXNJQzFvSUM4Z01pd2dkeXdnYUNrN0Nnb2dJR04wZUM1bWFXeHNVM1I1YkdVZ1BTQWlaM0psWlc0aU93b2dJR04wZUM1bWFXeHNLQ2s3Q2dvZ0lHTjBlQzV5WlhOMGIzSmxLQ2s3Q24wN0Nnb3ZMeUJNYVhOMFpXNGdkRzhnWVc0Z2FXNXdkWFFLWkdsemNHOXpaWEp6TG5CMWMyZ29DaUFnYldWMFlXWnlZVzFsTG05dVNXNXdkWFJ6S0NocGJuQjFkSE1wSUQwK0lIc0tJQ0FnSUcxbGRHRm1jbUZ0WlM1elpYUlBkWFJ3ZFhSektHbHVjSFYwY3lrN0NpQWdJQ0JqYjI1emRDQjVJRDBnYVc1d2RYUnpXeUo1SWwwN0NpQWdJQ0JwWmlBb0lYa3BJSHNLSUNBZ0lDQWdjbVYwZFhKdU93b2dJQ0FnZlFvZ0lDQWdaSEpoZHloNUtUc0tJQ0I5S1FvcE93cGtjbUYzS0RBcE93b0tMeThnVW1WMGRYSnVJR0VnWTJ4bFlXNTFjQ0JtZFc1amRHbHZiZ3B5WlhSMWNtNGdLQ2tnUFQ0Z2V3b2dJSGRvYVd4bElDaGthWE53YjNObGNuTXViR1Z1WjNSb0lENGdNQ2tnZXdvZ0lDQWdaR2x6Y0c5elpYSnpMbkJ2Y0NncEtDazdDaUFnZlFwOU93bz0mb3B0aW9ucz1leUpvYVdSbGJXVnVkV2xtYVdaeVlXMWxJanAwY25WbExDSnRiMlJsSWpvaWFtRjJZWE5qY21sd2RDSXNJbk5oZG1Wc2IyRmthVzVvWVhOb0lqcDBjblZsTENKMGFHVnRaU0k2SW14cFoyaDBJbjA9JnRleHQ9WTI5dWMzUWdaR2x6Y0c5elpYSnpJRDBnVzEwN0NtTnZibk4wSUhKdmIzUWdQU0JrYjJOMWJXVnVkQzVuWlhSRmJHVnRaVzUwUW5sSlpDZ2ljbTl2ZENJcE93cDNhR2xzWlNBb2NtOXZkQzVtYVhKemRFTm9hV3hrS1NCN0NpQWdjbTl2ZEM1eVpXMXZkbVZEYUdsc1pDaHliMjkwTG14aGMzUkRhR2xzWkNrN0NuMEtMeThnY21WdVpHVnlJSFJvWlNCaGJtZHNaUXAyWVhJZ1kyRnVkbUZ6SUQwZ1pHOWpkVzFsYm5RdVkzSmxZWFJsUld4bGJXVnVkQ2dpWTJGdWRtRnpJaWs3Q21OaGJuWmhjeTUzYVdSMGFDQTlJREl3TURzS1kyRnVkbUZ6TG1obGFXZG9kQ0E5SURJd01Ec0tjbTl2ZEM1aGNIQmxibVJEYUdsc1pDaGpZVzUyWVhNcE93b0tZMjl1YzNRZ1kzUjRJRDBnWTJGdWRtRnpMbWRsZEVOdmJuUmxlSFFvSWpKa0lpazdDbU52Ym5OMElGdDNMQ0JvWFNBOUlGc3lNQ3dnWTJGdWRtRnpMbWhsYVdkb2RGMDdDbU52Ym5OMElGdDRMQ0I1WFNBOUlGdGpZVzUyWVhNdWQybGtkR2dnTHlBeUxDQmpZVzUyWVhNdWFHVnBaMmgwSUM4Z01sMDdDZ3BqYjI1emRDQmtjbUYzSUQwZ0tISmhaQ2tnUFQ0Z2V3b2dJR04wZUM1amJHVmhjbEpsWTNRb01Dd2dNQ3dnWTJGdWRtRnpMbmRwWkhSb0xDQmpZVzUyWVhNdWFHVnBaMmgwS1RzS0NpQWdMeThnWm1seWMzUWdjMkYyWlNCMGFHVWdkVzUwY21GdWMyeGhkR1ZrTDNWdWNtOTBZWFJsWkNCamIyNTBaWGgwQ2lBZ1kzUjRMbk5oZG1Vb0tUc0tDaUFnWTNSNExtSmxaMmx1VUdGMGFDZ3BPd29nSUM4dklHMXZkbVVnZEdobElISnZkR0YwYVc5dUlIQnZhVzUwSUhSdklIUm9aU0JqWlc1MFpYSWdiMllnZEdobElISmxZM1FLSUNCamRIZ3VkSEpoYm5Oc1lYUmxLSGdzSUdnZ0x5QXlLVHNLSUNBdkx5QnliM1JoZEdVZ2RHaGxJSEpsWTNRS0lDQmpkSGd1Y205MFlYUmxLSEpoWkNrN0Nnb2dJQzh2SUdSeVlYY2dkR2hsSUhKbFkzUWdiMjRnZEdobElIUnlZVzV6Wm05eWJXVmtJR052Ym5SbGVIUUtJQ0JqZEhndWNtVmpkQ2d0ZHlBdklESXNJQzFvSUM4Z01pd2dkeXdnYUNrN0Nnb2dJR04wZUM1bWFXeHNVM1I1YkdVZ1BTQWlaM0psWlc0aU93b2dJR04wZUM1bWFXeHNLQ2s3Q2dvZ0lHTjBlQzV5WlhOMGIzSmxLQ2s3Q24wN0Nnb3ZMeUJNYVhOMFpXNGdkRzhnWVc0Z2FXNXdkWFFLWkdsemNHOXpaWEp6TG5CMWMyZ29DaUFnYldWMFlXWnlZVzFsTG05dVNXNXdkWFJ6S0NocGJuQjFkSE1wSUQwK0lIc0tJQ0FnSUcxbGRHRm1jbUZ0WlM1elpYUlBkWFJ3ZFhSektHbHVjSFYwY3lrN0NpQWdJQ0JqYjI1emRDQjVJRDBnYVc1d2RYUnpXeUo1SWwwN0NpQWdJQ0JwWmlBb0lYa3BJSHNLSUNBZ0lDQWdjbVYwZFhKdU93b2dJQ0FnZlFvZ0lDQWdaSEpoZHloNUtUc0tJQ0I5S1FvcE93cGtjbUYzS0RBcE93b0tMeThnVW1WMGRYSnVJR0VnWTJ4bFlXNTFjQ0JtZFc1amRHbHZiZ3B5WlhSMWNtNGdLQ2tnUFQ0Z2V3b2dJSGRvYVd4bElDaGthWE53YjNObGNuTXViR1Z1WjNSb0lENGdNQ2tnZXdvZ0lDQWdaR2x6Y0c5elpYSnpMbkJ2Y0NncEtDazdDaUFnZlFwOU93bz0ifX0sInBsdWdpbnMiOlsiaHR0cHM6Ly9tZXRhcGFnZXMub3JnL21ldGFmcmFtZXMvbWVybWFpZC5qcy8/VElUTEU9MCIsImh0dHBzOi8vZWRpdG9yLm10Zm0uaW8vIz9vcHRpb25zPWV5SnRiMlJsSWpvaWFuTnZiaUlzSW5OaGRtVnNiMkZrYVc1b1lYTm9JanBtWVd4elpTd2lkR2hsYldVaU9pSjJjeTFrWVhKckluMD0iXSwidmVyc2lvbiI6IjAuMyJ9&minimal=false)

## How it works

Using this URL for creation:

[https://js-create.mtfm.io](https://js-create.mtfm.io)

it generates a final metaframe URL (embedded values are base64 encoded):

https://js.mtfm.io/#?js=<<span style="color:blue">javascript</span>>&c=<<span style="color:red">modules</span>>




**Architecture:**

[![](https://mermaid.ink/svg/pako:eNpdUctOAzEM_JXISAikdou4gIKAA-W4JzihXMzG6abkpcRbitr-O9umUKk-WDP2eGTZG-iiJpCwyJh68T5XQYzROSxlTkb49BJdzMJY5-TF_Z2-MWZSOMcvOqPTb6u5l7dp_VA9yvBZTT0xJlxQLe-jvVLQM6ciZ7NlaTwb39g4u3helsemaS67fVZwLaU8LnCaPUcUdAWtmE6fxHZZBAYtOrFCN1DZikJ5RUeDiqtQ2KBp3fTs3Va0ta8CTMBT9mj1eJTNvqqAe_KkQI5Qk8HBsQIVdqN0SBqZXrXlmEEadIUmgAPHt5_QgeQ80J9obnE8h_9XJQwfMZ44HUza-o3DU3a_L1qDWw)](https://mermaid-js.github.io/mermaid-live-editor/edit#pako:eNpdUctOAzEM_JXISAikdou4gIKAA-W4JzihXMzG6abkpcRbitr-O9umUKk-WDP2eGTZG-iiJpCwyJh68T5XQYzROSxlTkb49BJdzMJY5-TF_Z2-MWZSOMcvOqPTb6u5l7dp_VA9yvBZTT0xJlxQLe-jvVLQM6ciZ7NlaTwb39g4u3helsemaS67fVZwLaU8LnCaPUcUdAWtmE6fxHZZBAYtOrFCN1DZikJ5RUeDiqtQ2KBp3fTs3Va0ta8CTMBT9mj1eJTNvqqAe_KkQI5Qk8HBsQIVdqN0SBqZXrXlmEEadIUmgAPHt5_QgeQ80J9obnE8h_9XJQwfMZ44HUza-o3DU3a_L1qDWw)


 - no state is stored on the server (all embedded in the URL)
   - this imposes some limits but current URL lengths are large or not specifically limited
 - The final URL is parsed by the server to create the single `index.html` with the modules and css embedded
 - The client then runs the embedded javascript (the javascript code is **not** sent to the server)

The server runs on https://deno.com/deploy which is

 - simple
 - fast
 - very performant
 - deploys immediately with a simply push to the repository
 - 🌟🌟🌟🌟🌟
